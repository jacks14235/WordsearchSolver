{"version":3,"sources":["logic/image-reader.ts","logic/bw-image-reader.ts","logic/solver.ts","logic/gradient.ts","logic/read-and-solve.ts","components/sparkles.tsx","components/read-and-solve.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ImageReader","width","height","data","this","x","y","i","BWImage","averageColor","v","buff","Uint8ClampedArray","getPixel","canvas","document","createElement","context","getContext","imdata","ImageData","toClamped","putImageData","newArray","Uint8Array","set","threshhold","corners","hiContrast","Math","floor","t","fill","setPixel","l","r","b","xPlus","xMinus","yPlus","yMinus","colorImage","nPixels","bwData","sum","avg","colorData","getData","console","log","w","h","WordSearch","letters","words","confidences","boxes","tst","map","toUpperCase","m","TST","initTST","length","Error","line","Array","from","yieldLine","join","add","dx","dy","reverse","solutions","word","get","forEach","p","push","start","end","dir","a","getBoxCenter","startX","startY","dirs","undefined","box","index","letter","sb","TSTNode","childL","childR","childM","endings","info","s","newNode","addEnding","createToBottom","root","getRecurse","curr","startIndex","addRecurse","node","Gradient","stops","positions","n","c","analyzeBoxes","contexts","modelPath","cropBoxes","Float32Array","max","padX","ceil","padY","x1","y1","x2","y2","boxIndices","Int32Array","allImageData","imageTensor","tf","boxTensor","boxIndicesTensor","CROP_SIZE","resizedTensor","cropAndResize","infer","img","g","stoplight","lineWidth","strokeStyle","eval","beginPath","rect","stroke","Promise","resolve","reject","model","out","predict","shape","ds","dataSync","maxes","normalized","normalize","o","arrayMax","slice","min","arrayMin","d","Sparkles","props","ref","useRef","className","style","count","_","Dot","useState","scale","setScale","setX","setY","grow","random","setTimeout","useEffect","transform","left","top","modelNames","WordsearchSolver","imgCanvas","boxCanvas","letterCanvas","lineCanvas","puzzle","setPuzzle","wordString","setWordString","imgVisible","setImgVisible","boxesVisible","setBoxesVisible","linesVisible","setLinesVisible","lettersVisible","setLettersVisible","rescaleVal","setRescaleVal","letterOffset","setLetterOffset","letterStyle","setLetterStyle","modelIndex","setModelIndex","loading","setLoading","canvasWidth","setcanvasWidth","canvasHeight","setCanvasHeight","changeLetterModal","setChangeLetterModal","onFileInput","e","current","target","files","f","image","Image","src","window","URL","webkitURL","createObjectURL","onload","screenWidth","outerWidth","rescale","drawImage","idt","getImageData","imgRead","bw","fromColor","toFill","copy","newBlank","getAverageColor","getPixeli","fillFromi","heights","maxHeight","freqs","argmax","reduce","freq","filteredBoxes","filter","sort","ws","analyzeImage","getWords","then","split","splice","pop","englishwords","reSolve","setWords","solve","lineCtx","clearRect","moveTo","lineTo","ctx","xProp","yProp","outerHeight","big","addEventListener","removeEventListener","toString","imgCtx","letterCtx","fontSize","font","fillStyle","getLetters","getBoxes","getConfidence","fillText","drawPuzzle","newLetterStyle","display","toDisp","inter","substring","lastIndexOf","name","onClick","type","onChange","imgPath","Tesseract","recognize","res","text","catch","err","alert","readWords","rows","value","ChangeLetterModal","puzzleWidth","close","newLetter","changeLetter","onChangeSumbit","getBoundingClientRect","clientX","clientY","clicked","inBox","canvasClick","setNewLetter","setLeft","setTop","right","setRight","bottom","setBottom","visualViewport","innerWidth","offsetLeft","offsetTop","innerHeight","onSubmit","autoFocus","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"6rl2BAEaA,EAAb,WACE,WAAmBC,EAAsBC,EAAwBC,GAAkB,yBAAhEF,QAA+D,KAAzCC,SAAyC,KAAjBC,OAC/DC,KAAKH,MAAQA,EACbG,KAAKF,OAASA,EACdE,KAAKD,KAAOA,EAJhB,2CAOE,WACE,OAAOC,KAAKD,OARhB,sBAWE,SAASE,EAAWC,GAClB,IAAMC,EAAIH,KAAKH,MAAQI,EAAIC,EAC3B,MAAO,CAACF,KAAKD,KAAKA,KAAKI,GAAIH,KAAKD,KAAKA,KAAKI,EAAI,GAAIH,KAAKD,KAAKA,KAAKI,EAAI,GAAIH,KAAKD,KAAKA,KAAKI,EAAI,QAbhG,K,gCCEaC,EAAb,WAEE,WAAoBL,EACDF,EACAC,EACCO,GAAuB,yBAHvBN,OAGsB,KAFvBF,QAEuB,KADvBC,SACuB,KAAtBO,eALtB,2CA0BE,WACE,OAAOL,KAAKD,OA3BhB,6BA8BE,WACE,OAAOC,KAAKK,eA/BhB,uBAkCE,SAAUF,GACR,OAAOH,KAAKD,KAAKI,KAnCrB,sBAsCE,SAASF,EAAWC,GAClB,OAAOF,KAAKD,KAAKE,EAAID,KAAKH,MAAQK,KAvCtC,sBA0CE,SAASD,EAAWC,EAAWI,GAC7BN,KAAKD,KAAKE,EAAID,KAAKH,MAAQK,GAAKI,IA3CpC,uBA8CE,WAEE,IADA,IAAMC,EAAO,IAAIC,kBAAkBR,KAAKH,MAAQG,KAAKF,OAAS,GACrDG,EAAI,EAAGA,EAAID,KAAKH,MAAOI,IAC9B,IAAK,IAAIC,EAAI,EAAGA,EAAIF,KAAKF,OAAQI,IAC/BK,EAAK,GAAKL,EAAIF,KAAKH,MAAQI,IAAMD,KAAKS,SAASR,EAAGC,GAClDK,EAAK,EAAI,GAAKL,EAAIF,KAAKH,MAAQI,IAAMD,KAAKS,SAASR,EAAGC,GACtDK,EAAK,EAAI,GAAKL,EAAIF,KAAKH,MAAQI,IAAMD,KAAKS,SAASR,EAAGC,GACtDK,EAAK,EAAI,GAAKL,EAAIF,KAAKH,MAAQI,IAAM,IAGzC,OAAOM,IAxDX,sBA2DE,WACE,IAAMG,EAASC,SAASC,cAAc,UAChCC,EAAUH,EAAOI,WAAW,MAC5BC,EAAS,IAAIC,UAAUhB,KAAKiB,YAAajB,KAAKH,OAEpD,OADO,OAAPgB,QAAO,IAAPA,KAASK,aAAaH,EAAQ,EAAG,GAC1BL,IAhEX,kBAmEE,WACE,IAAMS,EAAW,IAAIC,WAAWpB,KAAKH,MAAQG,KAAKF,QAElD,OADAqB,EAASE,IAAIrB,KAAKD,MACX,IAAIK,EACTe,EACAnB,KAAKH,MACLG,KAAKF,OACLE,KAAKK,gBA1EX,uBA6EE,SAAUF,EAAWmB,EAAoBC,EAAkBC,GACzD,IAAMvB,EAAIwB,KAAKC,MAAMvB,EAAIH,KAAKH,OACxBK,EAAIuB,KAAKC,MAAMvB,EAAIH,KAAKH,OACxB8B,EAAIH,EACVxB,KAAK4B,KAAK3B,EAAGC,EAAGoB,EAAYC,EAASI,KAjFzC,kBAoFE,SAAK1B,EAAWC,EAAWoB,EAAoBC,EAAkBC,GAC/D,GAAIxB,KAAKS,SAASR,EAAGC,GAAKoB,EAAY,CACpCtB,KAAK6B,SAAS5B,EAAGC,EAAG,KACpBsB,EAAWK,SAAS5B,EAAGC,EAAG,GACtBD,EAAIsB,EAAQO,IAAGP,EAAQO,EAAI7B,GAC3BA,EAAIsB,EAAQQ,IAAGR,EAAQQ,EAAI9B,GAC3BC,EAAIqB,EAAQI,IAAGJ,EAAQI,EAAIzB,GAC3BA,EAAIqB,EAAQS,IAAGT,EAAQS,EAAI9B,GAE/B,IAAM+B,EAAShC,EAAI,EACbiC,EAAUjC,EAAID,KAAKH,MAAQ,EAC3BsC,EAASjC,EAAI,EACbkC,EAAUlC,EAAIF,KAAKF,OAAS,EAG9BoC,GAAQlC,KAAK4B,KAAK3B,EAAI,EAAGC,EAAGoB,EAAYC,EAASC,GACjDS,GAAOjC,KAAK4B,KAAK3B,EAAI,EAAGC,EAAGoB,EAAYC,EAASC,GAChDY,GAAQpC,KAAK4B,KAAK3B,EAAGC,EAAI,EAAGoB,EAAYC,EAASC,GACjDW,GAAOnC,KAAK4B,KAAK3B,EAAGC,EAAI,EAAGoB,EAAYC,EAASC,GAEhDU,GAAUE,GAAQpC,KAAK4B,KAAK3B,EAAI,EAAGC,EAAI,EAAGoB,EAAYC,EAASC,GAC/DU,GAAUC,GAAOnC,KAAK4B,KAAK3B,EAAI,EAAGC,EAAI,EAAGoB,EAAYC,EAASC,GAC9DS,GAASG,GAAQpC,KAAK4B,KAAK3B,EAAI,EAAGC,EAAI,EAAGoB,EAAYC,EAASC,GAC9DS,GAASE,GAAOnC,KAAK4B,KAAK3B,EAAI,EAAGC,EAAI,EAAGoB,EAAYC,EAASC,OA3GvE,wBAOE,SAAiBa,GAMf,IALA,IAAMC,EAAUD,EAAWxC,MAAQwC,EAAWvC,OACxCyC,EAAS,IAAInB,WAAWkB,GAC1BE,EAAM,EACNC,EAAM,EACJC,EAA+BL,EAAWM,UAAU5C,KACjDI,EAAI,EAAGA,EAAImC,EAASnC,IAE3BqC,GADAC,EAAMhB,KAAKC,OAAOgB,EAAU,EAAIvC,GAAKuC,EAAU,EAAIvC,EAAI,GAAKuC,EAAU,EAAIvC,EAAI,IAAM,GAEpFoC,EAAOpC,GAAKsC,EAGd,OADAG,QAAQC,IAAIL,EAAKF,GACV,IAAIlC,EAAQmC,EAAQF,EAAWxC,MAAOwC,EAAWvC,OAAQ2B,KAAKC,MAAMc,EAAMF,MAnBrF,sBAsBE,SAAgBQ,EAAWC,GACzB,OAAO,IAAI3C,EAAQ,IAAIgB,WAAW0B,EAAIC,GAAGnB,KAAK,KAAMkB,EAAGC,EAAG,SAvB9D,K,0BCFaC,EAAb,WAIE,WACEC,EACOpD,EACAC,EACPoD,EACQC,EACAC,GAKR,GAL4B,yBAJrBvD,QAIoB,KAHpBC,SAGoB,KADnBqD,cACmB,KAAnBC,QAAmB,KATrBH,aASqB,OARrBI,SAQqB,OAPrBH,WAOqB,EAC3BlD,KAAKiD,QAAUA,EAAQK,KAAI,SAACxB,GAAD,OAAOA,EAAEyB,iBACpCvD,KAAKkD,MAAQA,EAAMI,KAAI,SAAAE,GAAC,OAAIA,EAAED,kBAAkB,GAChDvD,KAAKqD,IAAM,IAAII,EACfzD,KAAK0D,UACD1D,KAAKiD,QAAQU,SAAW3D,KAAKoD,MAAMO,OACrC,MAAM,IAAIC,MAAM,8CAhBtB,2CAoBE,WACE5D,KAAKqD,IAAM,IAAII,EAEf,IAAK,IAAIvD,EAAI,EAAGA,EAAIF,KAAKF,OAAQI,IAAK,CAEpC,IADA,IAAM2D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU,EAAG9D,EAAG,CAAC,EAAG,KAAK+D,KAAK,IAClD9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGE,EAAGD,EAAGA,EAAGiE,GAAI,EAAGC,GAAI,GAAIjE,GAKjD,IAHA,IAAMkE,EAAUP,MAAMC,KACpB/D,KAAKgE,UAAUhE,KAAKH,MAAQ,EAAGK,EAAG,EAAE,EAAG,KACvC+D,KAAK,IACE9D,EAAI,EAAGA,EAAIkE,EAAQV,OAAQxD,IAClCH,KAAKqD,IAAIa,IAAIG,EAAS,CAACpE,EAAGD,KAAKH,MAAQM,EAAI,EAAGD,EAAGA,EAAGiE,IAAK,EAAGC,GAAI,GAAIjE,GAIxE,IAAK,IAAIF,EAAI,EAAGA,EAAID,KAAKH,MAAOI,IAAK,CAEnC,IADA,IAAM4D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU/D,EAAG,EAAG,CAAC,EAAG,KAAKgE,KAAK,IAClD9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGA,EAAGC,EAAGC,EAAGgE,GAAI,EAAGC,GAAI,GAAIjE,GAKjD,IAHA,IAAMkE,EAAUP,MAAMC,KACpB/D,KAAKgE,UAAU/D,EAAGD,KAAKF,OAAS,EAAG,CAAC,GAAI,KACxCmE,KAAK,IACE9D,EAAI,EAAGA,EAAIkE,EAAQV,OAAQxD,IAClCH,KAAKqD,IAAIa,IAAIG,EAAS,CAACpE,EAAGA,EAAGC,EAAGF,KAAKF,OAASK,EAAI,EAAGgE,GAAI,EAAGC,IAAK,GAAIjE,GAIzE,IAAK,IAAID,EAAIF,KAAKF,OAAS,EAAGI,GAAK,EAAGA,IAEpC,IADA,IAAM2D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU,EAAG9D,EAAG,CAAC,EAAG,KAAK+D,KAAK,IAClD9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAG,EAAGC,EAAGA,EAAGiE,GAAI,EAAGC,GAAI,GAAIjE,GAGnD,IAAK,IAAIF,EAAI,EAAGA,EAAID,KAAKH,MAAOI,IAE9B,IADA,IAAM4D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU/D,EAAG,EAAG,CAAC,EAAG,KAAKgE,KAAK,IAClD9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGA,EAAGC,EAAG,EAAGiE,GAAI,EAAGC,GAAI,GAAIjE,GAInD,IAAK,IAAIF,EAAI,EAAGA,EAAID,KAAKH,MAAOI,IAE9B,IADA,IAAM4D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU/D,EAAGD,KAAKF,OAAS,EAAG,EAAE,GAAI,KAAKmE,KAAK,IAClE9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGA,EAAGC,EAAGF,KAAKF,OAAS,EAAGqE,IAAK,EAAGC,IAAK,GAAIjE,GAGrE,IAAK,IAAID,EAAIF,KAAKF,OAAS,EAAGI,GAAK,EAAGA,IAElC,IADA,IAAM2D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAUhE,KAAKH,MAAQ,EAAGK,EAAG,EAAE,GAAI,KAAK+D,KAAK,IACjE9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGD,KAAKH,MAAQ,EAAGK,EAAGA,EAAGiE,IAAK,EAAGC,IAAK,GAAIjE,GAIlE,IAAK,IAAIF,EAAI,EAAGA,EAAID,KAAKH,MAAOI,IAE9B,IADA,IAAM4D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU/D,EAAG,EAAG,EAAE,EAAG,KAAKgE,KAAK,IACnD9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGA,EAAGC,EAAG,EAAGiE,IAAK,EAAGC,GAAI,GAAIjE,GAGtD,IAAK,IAAID,EAAI,EAAGA,EAAIF,KAAKF,OAAQI,IAE7B,IADA,IAAM2D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAUhE,KAAKH,MAAQ,EAAGK,EAAG,EAAE,EAAG,KAAK+D,KAAK,IAChE9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGD,KAAKH,MAAQ,EAAGK,EAAGA,EAAGiE,IAAK,EAAGC,GAAI,GAAIjE,GAIjE,IAAK,IAAIF,EAAID,KAAKH,MAAQ,EAAGI,GAAK,EAAGA,IAEnC,IADA,IAAM4D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU/D,EAAGD,KAAKF,OAAS,EAAG,CAAC,GAAI,KAAKmE,KAAK,IACjE9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAGA,EAAGC,EAAGF,KAAKF,OAAS,EAAGqE,GAAI,EAAGC,IAAK,GAAIjE,GAGpE,IAAK,IAAID,EAAIF,KAAKF,OAAS,EAAGI,GAAK,EAAGA,IAElC,IADA,IAAM2D,EAAOC,MAAMC,KAAK/D,KAAKgE,UAAU,EAAG9D,EAAG,CAAC,GAAI,KAAK+D,KAAK,IACnD9D,EAAI,EAAGA,EAAI0D,EAAKF,OAAQxD,IAC/BH,KAAKqD,IAAIa,IAAIL,EAAM,CAAC5D,EAAG,EAAGC,EAAGA,EAAGiE,GAAI,EAAGC,IAAK,GAAIjE,KAjGxD,mBAsGE,WAA4B,IAAD,OAEzByC,QAAQC,IAAI7C,KAAKiD,SACjB,IAHyB,EAGnBqB,EAAqG,GAHlF,cAIRtE,KAAKkD,OAJG,yBAIhBqB,EAJgB,QAMX,EAAKlB,IAAImB,IAAID,GACrBE,SAAQ,SAAAC,GACVJ,EAAUK,KAAK,CACbJ,KAAMA,EACNK,MAAO,CAACF,EAAEzE,EAAGyE,EAAExE,GACf2E,IAAK,CAACH,EAAEzE,GAAKsE,EAAKZ,OAAS,GAAKe,EAAEP,GAAIO,EAAExE,GAAKqE,EAAKZ,OAAS,GAAKe,EAAEN,IAClEU,IAAK,CAACJ,EAAEP,GAAIO,EAAEN,UARpB,2BAA8B,IAJL,8BAkBzB,OAFAxB,QAAQC,IAAIyB,GACkBA,EAAUhB,KAAI,SAAAyB,GAAC,kCAASA,GAAT,IAAYH,MAAO,EAAKI,aAAL,QAAI,YAAiBD,EAAEH,QAAQC,IAAK,EAAKG,aAAL,QAAI,YAAiBD,EAAEF,aAvH/H,iCA2HE,WAAmBI,EAAgBC,EAAgBC,GAAnD,yEACMlF,EAAIgF,EACN/E,EAAIgF,EAFR,YAGSjF,GAAK,GAAKA,EAAID,KAAKH,OAASK,GAAK,GAAKA,EAAIF,KAAKF,QAHxD,gBAII,OAJJ,SAIUE,KAAKiD,QAAQhD,EAAID,KAAKH,MAAQK,GAJxC,OAKID,GAAKkF,EAAK,GACVjF,GAAKiF,EAAK,GANd,+DA3HF,uBAqIE,SAAUlF,EAAWC,GACnB,OAAOF,KAAKiD,QAAQjD,KAAKH,MAAQK,EAAID,KAtIzC,sBAyIE,SAASiD,GACPlD,KAAKkD,MAAQA,EAAMI,KAAI,SAAAR,GAAC,OAAIA,EAAES,mBA1IlC,0BA6IE,SAAapD,EAAW2B,GACtB9B,KAAKiD,QAAQ9C,GAAK2B,EAAEyB,cACpBvD,KAAK0D,YA/IT,0BAkJE,SAAazD,EAAWC,GACtB,IAAM8B,EAAIhC,KAAKoD,MAAMpD,KAAKH,MAAQK,EAAID,GACtC,MAAO,CAAC+B,EAAE,IAAMA,EAAE,GAAKA,EAAE,IAAM,EAAGA,EAAE,IAAMA,EAAE,GAAKA,EAAE,IAAM,KApJ7D,2BAuJE,SAAc7B,GACZ,OAAOH,KAAKmD,YAAYhD,IAAM,IAxJlC,mBA8JE,SAAMF,EAAWC,GAAwE,IAAD,OAClF6B,OAAgEqD,EAMpE,OALApF,KAAKoD,MAAMqB,SAAQ,SAACY,EAAKlF,GAClBkF,EAAI,GAAKpF,GAAOA,EAAIoF,EAAI,IAAQA,EAAI,GAAKnF,GAAOA,EAAImF,EAAI,KAC3DtD,EAAI,CAACuD,MAAOnF,EAAGoF,OAAQ,EAAKtC,QAAQ9C,GAAIkF,WAGrCtD,IArKX,sBAwKE,WACE,OAAO/B,KAAKoD,QAzKhB,wBA4KE,WACE,OAAOpD,KAAKiD,UA7KhB,sBAgLE,WACE,OAAOjD,KAAKkD,QAjLhB,sBAoLE,WAAY,IAAD,OACLsC,EAAK,GAOT,OANAxF,KAAKiD,QAAQwB,SAAQ,SAAC3C,EAAG3B,GACb,IAANA,GAAWA,EAAI,EAAKN,QAAU,IAChC2F,GAAM,MAERA,GAAM1D,EAAI,OAEL0D,MA5LX,KAuMMC,E,WAKJ,WAAmBF,GAAiB,yBAAjBA,SAAgB,KAJ5BG,OAAyB,KAIG,KAH5BC,OAAyB,KAGG,KAF5BC,OAAyB,KAEG,KAD5BC,QAA0B,G,6CAGjC,SAAiBC,GACf9F,KAAK6F,QAAQlB,KAAKmB,M,6BAGpB,SACEC,EACAT,EACAQ,GAEA,IAAME,EAAU,IAAIP,EAAQM,EAAET,IAC9B,OAAIA,IAAUS,EAAEpC,OAAS,GACvBqC,EAAQC,UAAUH,GACXE,IAETA,EAAQJ,OAAS5F,KAAKkG,eAAeH,EAAGT,EAAQ,EAAGQ,GACnDE,EAAQC,UAAUH,GACXE,O,KAIEvC,EAAb,iDACU0C,KAAuB,KADjC,uCAGE,SAAWJ,GACT,OAAK/F,KAAKmG,KACHnG,KAAKoG,WAAWL,EAAG,EAAG/F,KAAKmG,MADX,KAJ3B,wBAQE,SACEJ,EACAT,EACAe,GAEA,OAAIA,EAAKd,SAAWQ,EAAET,GAChBA,IAAUS,EAAEpC,OAAS,EAAU0C,EAAKR,QACpCQ,EAAKT,OAAe5F,KAAKoG,WAAWL,EAAGT,EAAQ,EAAGe,EAAKT,QAC/C,GACHG,EAAET,GAASe,EAAKd,OACrBc,EAAKV,OAAe3F,KAAKoG,WAAWL,EAAGT,EAAOe,EAAKV,QAC3C,GAERU,EAAKX,OAAe1F,KAAKoG,WAAWL,EAAGT,EAAOe,EAAKX,QAC3C,KAtBlB,iBA0BE,SAAWK,EAAWD,EAAoBQ,GACnCtG,KAAKmG,OACRnG,KAAKmG,KAAOV,EAAQS,eAAeH,EAAGO,GAAc,EAAGR,IACzD9F,KAAKuG,WAAWvG,KAAKmG,KAAMJ,EAAGO,GAAc,EAAGR,KA7BnD,wBAgCE,SACEU,EACAT,EACAT,EACAQ,GAEA,GAAIC,EAAET,KAAWkB,EAAKjB,OAAQ,CAE5B,GADAiB,EAAKP,UAAUH,GACXR,IAAUS,EAAEpC,OAAS,EACvB,OAEF3D,KAAKuG,WACHC,EAAKZ,SACFY,EAAKZ,OAASH,EAAQS,eAAeH,EAAGT,EAAQ,EAAGQ,IACtDC,EACAT,EAAQ,EACRQ,QAEOC,EAAET,GAASkB,EAAKjB,OACrBiB,EAAKb,OACP3F,KAAKuG,WAAWC,EAAKb,OAAQI,EAAGT,EAAOQ,GAEvCU,EAAKb,OAASF,EAAQS,eAAeH,EAAGT,EAAOQ,GAG7CU,EAAKd,OACP1F,KAAKuG,WAAWC,EAAKd,OAAQK,EAAGT,EAAOQ,GAEvCU,EAAKd,OAASD,EAAQS,eAAeH,EAAGT,EAAOQ,OA5DvD,KCpOaW,EAAb,WACE,WAAoBC,EACAC,GAAsB,yBADtBD,QACqB,KAArBC,YAFtB,wCAIE,SAAKC,GAAY,IAAD,OACVtB,EAAQ,EACZ,GAAS,GAALsB,EACF,OAAO5G,KAAK0G,MAAM,GAEpB,KAAOE,EAAI5G,KAAK2G,UAAUrB,IACxBA,IACF,IAAMvD,GAAK6E,EAAI5G,KAAK2G,UAAUrB,EAAQ,KAAOtF,KAAK2G,UAAUrB,GAAStF,KAAK2G,UAAUrB,EAAQ,IAC5F,OAAQtF,KAAK0G,MAAMpB,EAAQ,GAAGhC,KAAI,SAACuD,EAAE1G,GAAH,OAAS0G,GAAK,EAAKH,MAAMpB,GAAOnF,GAAK0G,GAAK9E,QAZhF,wBAeE,WACE,OAAO,IAAI0E,EAAS,CAAC,CAAC,IAAK,IAAK,KAAM,CAAC,IAAK,EAAG,GAAI,CAAC,EAAG,IAAK,IAAK,CAAC,EAAG,GAAI,QAhB7E,K,SCiDeK,E,sFAAf,WAA4BtF,EAAqB4B,EAAmBF,EAAiB6D,EAAoBC,GAAzG,2CAAAjC,EAAA,6DACEnC,QAAQC,IAAI,gBACNoE,EAAY,IAAIC,aAA4B,EAAf9D,EAAMO,QACvB,EACZb,EAAItB,EAAW3B,MAAQ,EACvBkD,EAAIvB,EAAW1B,OAAS,EAC9BsD,EAAMqB,SAAQ,SAACzC,EAAG7B,GAChB,IAAMgE,EAAKnC,EAAE,GAAKA,EAAE,GACdoC,EAAKpC,EAAE,GAAKA,EAAE,GACdmF,EAAM1F,KAAK0F,IAAIhD,EAAIC,GACnBgD,EAAO3F,KAAK4F,MAAMF,EAAMhD,GAAM,GAPpB,EAQVmD,EAAO7F,KAAK4F,MAAMF,EAAM/C,GAAM,GARpB,EASVmD,EAAKvF,EAAE,GAAKoF,EACZI,EAAKxF,EAAE,GAAKsF,EACZG,EAAKzF,EAAE,GAAKoF,EACZM,EAAK1F,EAAE,GAAKsF,EAClBL,EAAc,EAAJ9G,GAASqH,EAAKzE,EACxBkE,EAAc,EAAJ9G,EAAQ,GAAKoH,EAAKzE,EAC5BmE,EAAc,EAAJ9G,EAAQ,GAAKuH,EAAK3E,EAC5BkE,EAAc,EAAJ9G,EAAQ,GAAKsH,EAAK3E,KAGxB6E,EAAa,IAAIC,WAAWxE,EAAMO,QAAQ/B,KAAK,GAE/CiG,EAAerG,EAAWmB,UAG1BmF,EAAqCC,IAAUF,EAAc,CAAC,EAAGrG,EAAW1B,OAAQ0B,EAAW3B,MAAO,IACtGmI,EAAmCD,IAAUd,EAAW,CAAC7D,EAAMO,OAAQ,IACvEsE,EAA0CF,IAAUJ,EAAY,CAACvE,EAAMO,SACvEuE,EAA8B,CAAC,GAAI,IAGnCC,EAAgBJ,IAASK,cAAcN,EAAaE,EAAWC,EAAkBC,GAjCzF,UAkCwBG,EAAMF,EAAenB,GAlC7C,QAkDE,IAhBM/D,EAlCR,OAqCE8D,EAAS1B,IAAI3E,OAAOb,MAAQkH,EAASuB,IAAI5H,OAAOb,MAChDkH,EAAS1B,IAAI3E,OAAOZ,OAASiH,EAASuB,IAAI5H,OAAOZ,OAC3CyI,EAAI9B,EAAS+B,YACnBzB,EAAS1B,IAAIoD,UAAY,EACzBrF,EAAMqB,SAAQ,SAACzC,EAAG7B,GAChB4G,EAAS1B,IAAIqD,YAAb,cAAkCH,EAAEI,KAAK1F,EAAQ9C,GAAG,IAAI8D,KAAK,KAA7D,KACA8C,EAAS1B,IAAIuD,YACb7B,EAAS1B,IAAIwD,KAAK7G,EAAE,GAAK,EAAGA,EAAE,GAAK,EAAGA,EAAE,GAAKA,EAAE,GAAK,EAAGA,EAAE,GAAKA,EAAE,GAAK,GACrE+E,EAAS1B,IAAIyD,YAIXjJ,EAAQ,EACLuD,EAAMvD,GAAO,GAAKuD,EAAMvD,EAAQ,GAAG,IAAIA,IAlDhD,OAmDEA,IACMC,EAASsD,EAAMO,OAAS9D,EACxBsD,EAAcF,EAAQK,KAAI,SAAAxB,GAAC,OAAIA,EAAE,MACvCc,QAAQC,IAAIhD,EAAOC,GAtDrB,kBAwDS,IAAIkD,EAAWC,EAAQK,KAAI,SAAAxB,GAAC,OAAIA,EAAE,MAAKjC,EAAOC,EAAQoD,EAAOC,EAAaC,IAxDnF,6C,sBA2DA,SAASiF,EAAM1G,EAA0BqF,GAEvC,OADApE,QAAQC,IAAI,kBAAmBmE,GACxB,IAAI+B,QAAJ,uCAAuB,WAAOC,EAASC,GAAhB,uBAAAlE,EAAA,sEACRgD,IAAkBf,GAAa,oCADvB,OACtBkC,EADsB,OAEtBC,EAAMD,EAAME,QAAQzH,GAC1BiB,QAAQC,IAAIsG,EAAIE,OACVC,EAAKH,EAAII,WACTC,EAAQ1F,MAAMC,KAAKgE,IAAUoB,EAAK,GAAGI,YAErCE,EAAaC,EAAUJ,EAAI,EAAG,GACpCN,EAASQ,EAAMlG,KAAI,SAACqG,EAAGxJ,GAAJ,MAAU,CA/GhB,6BA+G0BwJ,GAAIC,EAASH,EAAWI,MAAM,GAAK1J,EAAG,IAAMA,EAAI,UAR3D,2CAAvB,yDAYT,SAASuJ,EAAU3J,EAAyDgF,EAAW/C,GACrF,IAAMmF,EAAMyC,EAAS7J,GACf+J,EAcR,SAAkB/E,GAEhB,IADA,IAAIvB,EAAIuB,EAAE,GACD5E,EAAI,EAAGA,EAAI4E,EAAEpB,OAAQxD,IACxB4E,EAAE5E,GAAKqD,IACTA,EAAIuB,EAAE5E,IAEV,OAAOqD,EApBKuG,CAAShK,GACrB,OAAOA,EAAKuD,KAAI,SAAA0G,GAAC,OAAMA,EAAIF,IAAQ3C,EAAM2C,IAAS9H,EAAI+C,GAAKA,KAI7D,SAAS6E,EAAS7E,GAEhB,IADA,IAAIvB,EAAIuB,EAAE,GACD5E,EAAI,EAAGA,EAAI4E,EAAEpB,OAAQxD,IACxB4E,EAAE5E,GAAKqD,IACTA,EAAIuB,EAAE5E,IAEV,OAAOqD,E,uCCpIF,SAASyG,EAASC,GACrB,IAAMC,EAAMC,iBAAuB,MAEnC,OACI,qBACID,IAAKA,EACLE,UAAU,yCACVC,MAAO,CAAEzK,MAAM,GAAD,OAAKqK,EAAMrK,MAAX,MAAsBC,OAAO,GAAD,OAAKoK,EAAMpK,OAAX,OAH9C,SAIK,IAAIgE,MAAMoG,EAAMK,OAAO3I,KAAK,GAAG0B,KAAI,SAAAkH,GAAC,OAAI,cAACC,EAAD,CAAK3K,OAAQoK,EAAMpK,OAAQD,MAAOqK,EAAMrK,aAK7F,SAAS4K,EAAIP,GAET,MAA0BQ,qBAA1B,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAAkBF,qBAAlB,mBAAOzK,EAAP,KAAU4K,EAAV,KACA,EAAkBH,qBAAlB,mBAAOxK,EAAP,KAAU4K,EAAV,KASA,SAASC,IACLH,EAAyB,GAAhBnJ,KAAKuJ,SAAgB,IAC9BC,YAAW,kBAIXL,EAAS,QACTK,YAAW,WACPJ,EAAKpJ,KAAKuJ,WAAad,EAAMrK,OAAS,IAAM,KAC5CiL,EAAKrJ,KAAKuJ,WAAad,EAAMpK,QAAU,IAAM,KAC7CiL,MACD,OATwB,KAY/B,OArBAG,qBAAU,WACNL,EAAKpJ,KAAKuJ,WAAad,EAAMrK,OAAS,IAAM,KAC5CiL,EAAKrJ,KAAKuJ,WAAad,EAAMpK,QAAU,IAAM,KAC7C8K,EAAS,GACTK,YAAW,kBAAMF,MAAwB,IAAhBtJ,KAAKuJ,YAC/B,CAACd,EAAMpK,OAAQoK,EAAMrK,QAiBpB,qBACIwK,UAAU,yFACVC,MAAO,CAAEa,UAAU,SAAD,OAAWR,EAAX,KAAqBS,KAAMnL,EAAGoL,IAAKnL,KCxBjE,IAAMoL,EAAa,CAAC,mCAAoC,kCAEjD,SAASC,IACd,IAAMC,EAAYpB,iBAA0B,MACtCqB,EAAYrB,iBAA0B,MACtCsB,EAAetB,iBAA0B,MACzCuB,EAAavB,iBAA0B,MAC7C,EAA4BM,qBAA5B,mBAAOkB,EAAP,KAAeC,EAAf,KACA,EAAoCnB,mBAAiB,IAArD,mBAAOoB,EAAP,KAAmBC,EAAnB,KACA,EAAoCrB,oBAAkB,GAAtD,mBAAOsB,EAAP,KAAmBC,EAAnB,KACA,EAAwCvB,oBAAkB,GAA1D,mBAAOwB,EAAP,KAAqBC,EAArB,KACA,EAAwCzB,oBAAkB,GAA1D,mBAAO0B,EAAP,KAAqBC,EAArB,KACA,EAA4C3B,oBAAkB,GAA9D,mBAAO4B,EAAP,KAAuBC,EAAvB,KACA,EAAoC7B,mBAAiB,GAArD,mBAAO8B,EAAP,KAAmBC,EAAnB,KACA,EAAwC/B,mBAAiB,GAAzD,mBAAOgC,EAAP,KAAqBC,EAArB,KACA,EAAsCjC,qBAAtC,mBAAOkC,EAAP,KAAoBC,GAApB,KACA,GAAoCnC,mBAAiB,GAArD,qBAAOoC,GAAP,MAAmBC,GAAnB,MACA,GAA8BrC,oBAAkB,GAAhD,qBAAOsC,GAAP,MAAgBC,GAAhB,MACA,GAAsCvC,mBAAiB,GAAvD,qBAAOwC,GAAP,MAAoBC,GAApB,MACA,GAAwCzC,mBAAiB,GAAzD,qBAAO0C,GAAP,MAAqBC,GAArB,MACA,GAAkD3C,qBAAlD,qBAAO4C,GAAP,MAA0BC,GAA1B,MA6CA,SAASC,GAAYC,GAAyC,IAAD,UACrDnF,EAAG,UAAGkD,EAAUkC,eAAb,aAAG,EAAmB5M,WAAW,MACpCuE,EAAG,UAAGoG,EAAUiC,eAAb,aAAG,EAAmB5M,WAAW,MACpCyE,EAAM,UAAGmG,EAAagC,eAAhB,aAAG,EAAsB5M,WAAW,MAC1C+C,EAAI,UAAG8H,EAAW+B,eAAd,aAAG,EAAoB5M,WAAW,MAC5C,GAAMwH,GAAOjD,GAAOE,GAAU1B,EAA9B,CACA,IAAMkD,EAAqB,CAAEuB,MAAKjD,MAAKE,SAAQ1B,QAC/C,IAAI,UAAA4J,EAAEE,OAAOC,aAAT,eAAgBjK,SAAU8J,EAAEE,OAAOC,MAAMjK,OAAS,EAAG,CACvD,IAAMkK,EAAUJ,EAAEE,OAAOC,MAAM,GACzBE,EAAQ,IAAIC,MAEhBC,GADUC,OAAOC,KAAOD,OAAOE,WACrBC,gBAAgBP,GAC5BC,EAAME,IAAMA,EACZF,EAAMO,OAAS,WACb,IAAMC,EAAcL,OAAOM,WACjB9M,KAAKqI,IAAIwE,EAAa,KACjBR,EAAMjO,MAASiO,EAAMhO,OACpCwI,EAAI5H,OAAOb,MAAQiO,EAAMjO,MACzByI,EAAI5H,OAAOZ,OAASgO,EAAMhO,OAC1BqN,GAAeW,EAAMjO,OACrBwN,GAAgBS,EAAMhO,QACtB0O,KAEAlG,EAAImG,UAAUX,EAAO,EAAG,EAAGA,EAAMjO,MAAOiO,EAAMhO,QAC9C8C,QAAQC,IAAI,eAAgBiL,EAAMjO,MAAO,IAAKiO,EAAMhO,QACpD,IAAM4O,EAAMpG,EAAIqG,aAAa,EAAG,EAAGb,EAAMjO,MAAOiO,EAAMhO,QACtD8C,QAAQC,IAAI6L,GACZ,IAAME,EAAU,IAAIhP,EAAYkO,EAAMjO,MAAOiO,EAAMhO,OAAQ4O,GAC3DzB,IAAW,GFzGZ,SAAsB3E,EAAkBpF,EAAiB6D,EAAoBC,GAElF,OADApE,QAAQC,IAAI,gBACL,IAAIkG,QAAJ,uCAAwB,WAAOC,EAASC,GAAhB,yCAAAlE,EAAA,sDAS7B,IARM8J,EAAKzO,EAAQ0O,UAAUxG,GACvByG,EAASF,EAAGG,OACZxN,EAAapB,EAAQ6O,SAASJ,EAAGhP,MAAOgP,EAAG/O,QAE3CwC,EAAUuM,EAAGhP,MAAQgP,EAAG/O,OACxBwB,EAAayN,EAAOG,kBAAoB,GACxC3N,EAAU,CAAEO,EAAGiN,EAAOlP,MAAOkC,EAAG,EAAGJ,EAAGoN,EAAOjP,OAAQkC,EAAG,GACxDoB,EAAQ,GACLjD,EAAI,EAAGA,EAAImC,EAASnC,IACvB4O,EAAOI,UAAUhP,GAAKmB,IACxBC,EAAQO,EAAIiN,EAAOlP,MACnB0B,EAAQQ,EAAI,EACZR,EAAQI,EAAIoN,EAAOjP,OACnByB,EAAQS,EAAI,EACZ+M,EAAOK,UAAUjP,EAAGmB,EAAYC,EAASC,GACzC4B,EAAMuB,KAAK,CAACpD,EAAQO,EAAGP,EAAQQ,EAAGR,EAAQI,EAAGJ,EAAQS,KAhB5B,OAwBvBqN,EAAUjM,EAAME,KAAI,SAAA+B,GAAG,OAAIA,EAAI,GAAKA,EAAI,MACxCiK,EAAY7N,KAAK0F,IAAL,MAAA1F,KAAI,YAAQ4N,IACxBE,EAAQ,IAAIzL,MAAMwL,EAAY,GAAG1N,KAAK,GAC5CyN,EAAQ5K,SAAQ,SAAA1B,GAAC,OAAIwM,EAAMxM,QACrByM,EAA2BD,EAAME,QAAO,SAACjG,EAAOkG,EAAMvP,GAAd,OAAoBuP,EAAOlG,EAAM,GAAK,CAACkG,EAAMvP,GAAKqJ,IAAO,CAAC6F,EAAQ,GAAI,KAE9GM,EAAgBvM,EAAMwM,QAAO,SAAA5N,GAAC,OAAIwN,EAAO,GAPvB,EAO8CxN,EAAE,GAAKA,EAAE,IAAMA,EAAE,GAAKA,EAAE,IAAMwN,EAAO,GAPnF,MAQVK,MAAK,SAAC9K,EAAG/C,GAAJ,OAAU+C,EAAE,GAAK/C,EAAE,GAAKwN,EAAO,GAAK,EAAIzK,EAAE,GAAK/C,EAAE,MA/BvC,UAgCZ8E,EAAatF,EAAYmO,EAAezM,EAAO6D,EAAUC,GAhC7C,QAgCvB8I,EAhCuB,OAiC7B9G,EAAQ8G,GAjCqB,4CAAxB,yDEwGDC,CAAanB,EAASoB,KAAYjJ,EAAUuE,EAAWwB,KACpDmD,MAAK,SAACH,GACLjE,EAAUiE,SAMpB,SAASE,KACP,IAAM9M,EAAQ4I,EAAWoE,MAAM,iBAG/B,MAFiB,KAAbhN,EAAM,IAAWA,EAAMiN,OAAO,EAAG,GACL,KAA5BjN,EAAMA,EAAMS,OAAS,IAAWT,EAAMkN,MACtClN,EAAMS,OAAS,GACjBf,QAAQC,IAAIK,GACLA,GAEFmN,EAAaT,QAAO,SAAA9M,GAAC,OAAIA,EAAEa,OAAS,KA4C7C,SAAS2M,KAAW,IAAD,EACXpN,EAAQ8M,KACR,OAANpE,QAAM,IAANA,KAAQ2E,SAASrN,GACjB,IAAMoB,EAAS,OAAGsH,QAAH,IAAGA,OAAH,EAAGA,EAAQ4E,QAC1B5N,QAAQC,IAAIyB,GACZ,IAAMmM,EAAO,UAAG9E,EAAW+B,eAAd,aAAG,EAAoB5M,WAAW,MAC1CwD,IACE,OAAPmM,QAAO,IAAPA,KAASC,UAAU,EAAG,EAAGD,EAAQ/P,OAAOb,MAAO4Q,EAAQ/P,OAAOZ,QAC1D2Q,IACFA,EAAQhI,UAAY,EACpBgI,EAAQ/H,YAAc,YACtBpE,EAAUG,SAAQ,SAAAsB,GAChB0K,EAAQ7H,YACR6H,EAAQE,OAAO5K,EAAEnB,MAAM,GAAImB,EAAEnB,MAAM,IACnC6L,EAAQG,OAAO7K,EAAElB,IAAI,GAAIkB,EAAElB,IAAI,IAC/B4L,EAAQ3H,cAKd,SAAS0F,KAAW,IAAD,EAEXqC,EAAG,UAAGrF,EAAUkC,eAAb,aAAG,EAAmB5M,WAAW,MAC1C,GAAK+P,EAAL,CACA,IAAIC,EAAQD,EAAInQ,OAAOb,MAAQoO,OAAOM,WAChCwC,EAAQF,EAAInQ,OAAOZ,OAASmO,OAAO+C,YACrC/C,OAAOM,WAAa,MACtBuC,GAAS,IAEX,IAAMG,EAAMxP,KAAK0F,IAAI2J,EAAOC,GAC5BtE,EAAc,GAAKwE,IA5JrB/F,qBAAU,WAER,OADA+C,OAAOiD,iBAAiB,SAAU1C,IAC1B,kBAAMP,OAAOkD,oBAAoB,SAAU3C,OAClD,IAEHtD,qBAAU,YAgFV,WAAuB,IAAD,MACpB,IAAKU,EAAQ,OACb,IAAMtH,EAAYsH,EAAO4E,QACzB5N,QAAQC,IAAIyB,GACZ1B,QAAQC,IAAI,QAASyB,EAAUX,OAAQ,eAAgBiI,EAAOoE,WAAWrM,QACzEf,QAAQC,IAAI+I,EAAOwF,YAEnB,IAAMC,EAAM,UAAG7F,EAAUkC,eAAb,aAAG,EAAmB5M,WAAW,MAC7C,IAAKuQ,EAAQ,OAEb,IAAMZ,EAAO,UAAG9E,EAAW+B,eAAd,aAAG,EAAoB5M,WAAW,MAC3C2P,IACFA,EAAQ/P,OAAOb,MAAQwR,EAAO3Q,OAAOb,MACrC4Q,EAAQ/P,OAAOZ,OAASuR,EAAO3Q,OAAOZ,OACtC2Q,EAAQhI,UAAY,EACpBgI,EAAQ/H,YAAc,YACtBpE,EAAUG,SAAQ,SAAAsB,GAChB0K,EAAQ7H,YACR6H,EAAQE,OAAO5K,EAAEnB,MAAM,GAAImB,EAAEnB,MAAM,IACnC6L,EAAQG,OAAO7K,EAAElB,IAAI,GAAIkB,EAAElB,IAAI,IAC/B4L,EAAQ3H,aAIZ,IAAMwI,EAAS,UAAG5F,EAAagC,eAAhB,aAAG,EAAsB5M,WAAW,MACnD,GAAIwQ,EAAW,CACb,IAAMC,EAAW9P,KAAKC,MAAM,GAAK2P,EAAO3Q,OAAOb,MAAQ+L,EAAO/L,OAC9DyR,EAAU5Q,OAAOb,MAAQwR,EAAO3Q,OAAOb,MACvCyR,EAAU5Q,OAAOZ,OAASuR,EAAO3Q,OAAOZ,OACxCwR,EAAUE,KAAV,eAAyBD,EAAzB,YACAD,EAAUG,UAAY,YACtB,IAAMxO,EAAU2I,EAAO8F,aACjBnJ,EAAI9B,EAAS+B,YACnBoD,EAAO+F,WAAWlN,SAAQ,SAACsB,EAAG5F,GAC5BmR,EAAUG,UAAV,cAA6BlJ,EAAEI,KAAKiD,EAAOgG,cAAczR,IAAI8D,KAAK,KAAlE,KACAqN,EAAUO,SAAS5O,EAAQ9C,GAAG,GAAI4F,EAAE,GAAIA,EAAE,OAG9CkH,IAAW,GArHX6E,KACC,CAAClG,IAMJV,qBAAU,WACR,IAAM6G,EAAiB,CACrBC,QAASC,GAAO3F,GAChBnB,UANI,SAAN,OAAgBqB,EAAhB,wBAA0CE,EAA1C,QAQAG,GAAekF,KACd,CAACzF,EAAgBE,EAAYE,IA4KhC,IAAMuF,GAAS,SAACjQ,GAAD,OAAgBA,EAAI,QAAU,QAI7C,OAFAkJ,qBAAU,kBAAMtI,QAAQC,IAAI6J,KAAe,CAACA,IAG1C,sBAAKrC,UAAU,4BAAf,UACE,sBAAKA,UAAU,6HAAf,UACE,qBAAKA,UAAU,gBAAf,SAEIiB,EACGhI,KAAI,SAAC4F,EAAO/I,GACX,IAAM+R,EAAQhJ,EAAMiJ,UAAU,EAAGjJ,EAAMkJ,YAAY,MAC7CC,EAAOH,EAAMC,UAAUD,EAAME,YAAY,KAAO,GACtD,OAAO,wBAAQ/H,UAAS,0DAAqDyC,KAAe3M,EAAI,cAAgB,WAAxF,yEAA2KmS,QAAS,kBAAMvF,GAAc5M,IAAzN,SAA8NkS,SAI7O,mBAAGhI,UAAU,+BAAb,2CACA,uBAAOkI,KAAK,OAAOC,SAAU,SAAC/E,GAAD,OAAOD,GAAYC,MAChD,mBAAGpD,UAAU,+BAAb,kDACA,uBAAOkI,KAAK,OAAOC,SAAU,SAAC/E,GAAD,OA9LnC,SAAmBA,GAAyC,IAAD,EACzD,IAAI,UAAAA,EAAEE,OAAOC,aAAT,eAAgBjK,SAAU8J,EAAEE,OAAOC,MAAMjK,OAAS,EAAG,CACvD,IAAM8O,EAAkBvE,IAAIE,gBAAgBX,EAAEE,OAAOC,MAAM,IAC3DhL,QAAQC,IAAI,eACZD,QAAQC,IAAI4P,GACZC,IAAUC,UAAUF,EAAS,OAC1BxC,MAAK,SAAA2C,GACJhQ,QAAQC,IAAI+P,GACZ7G,EAAc6G,EAAI7S,KAAK8S,SAExBC,OAAM,SAAAC,GAAG,OAAInQ,QAAQC,IAAIkQ,WAE5BC,MAAM,gBAkLgCC,CAAUxF,MAC9C,mBAAGpD,UAAU,+BAAb,wFACA,sBAAKA,UAAU,kCAAf,UACE,0BAAUA,UAAU,kDAAkD6I,KAAM,EAAGC,MAAOrH,EAAY0G,SAAU,SAAC/E,GAAD,OAAO1B,EAAc0B,EAAEE,OAAOwF,UAC1I,wBAAQ9I,UAAU,+CAA+CiI,QAAShC,GAA1E,uBAEDhD,IAAqB,cAAC8F,EAAD,CAAmBvC,IAAKvD,GAAkBuD,IAC9DvL,MAAOgI,GAAkBhI,MACzBC,OAAQ+H,GAAkB/H,OAC1BF,IAAKiI,GAAkBjI,IACvBgO,YAAa/F,GAAkB+F,YAC/BC,MAAO,SAACC,GAAD,OAxCf,SAAwBA,GACjBjG,KACDiG,IACI,OAAN3H,QAAM,IAANA,KAAQ4H,aAAalG,GAAkBhI,MAAOiO,GAC9CjD,MAEF/C,QAAqBnI,IAkCOqO,CAAeF,MAEvC,wBAAQlJ,UAAS,qDAAgD2B,EAAa,cAAgB,cAA7E,yEAAmKsG,QAAS,kBAAMrG,GAAeD,IAAlN,0BACA,wBAAQ3B,UAAS,qDAAgD6B,EAAe,cAAgB,cAA/E,yEAAqKoG,QAAS,kBAAMnG,GAAiBD,IAAtN,0BACA,wBAAQ7B,UAAS,qDAAgD+B,EAAe,cAAgB,cAA/E,yEAAqKkG,QAAS,kBAAMjG,GAAiBD,IAAtN,8BACA,wBAAQ/B,UAAS,qDAAgDiC,EAAiB,cAAgB,cAAjF,yEAAuKgG,QAAS,kBAAM/F,GAAmBD,IAA1N,4BACA,sBAAKjC,UAAU,+BAAf,UACE,wBAAQA,UAAS,sIAAyIiI,QAAS,kBAAM3F,EAAgBD,EAAe,IAAxM,SAA8M,MAC9M,wBAAQrC,UAAS,sIAAyIiI,QAAS,kBAAM3F,EAAgBD,EAAe,IAAxM,SAA8M,YAIlN,sBAAKrC,UAAU,+BAA+BC,MAAO,GAArD,UACE,wBAAQD,UAAU,0DAA0DF,IAAKqB,EAAWlB,MAAO,CAAE0H,QAASC,GAAOjG,GAAab,UAAU,SAAD,OAAWqB,EAAX,QAC1IQ,IAAW,cAAC/C,EAAD,CAAUpK,MAAOqN,GAAcV,EAAY1M,OAAQsN,GAAeZ,EAAYjC,MAAO,KACjG,wBAAQF,UAAU,0DAA0DF,IAAKsB,EAAWnB,MAAO,CAAE0H,QAASC,GAAO/F,GAAef,UAAU,SAAD,OAAWqB,EAAX,QAC7I,wBAAQnC,UAAU,0DAA0DF,IAAKwB,EAAYrB,MAAO,CAAE0H,QAASC,GAAO7F,GAAejB,UAAU,SAAD,OAAWqB,EAAX,QAC9I,wBAAQnC,UAAU,+DAA+DF,IAAKuB,EAAc4G,QAAS,SAAA7E,GAAC,OAhFpH,SAAqBA,GACnB,IAAM/M,EAASgL,EAAagC,QAE5B,GADA9K,QAAQC,IAAI,WACPnC,GAAWkL,EAAhB,CACA,IAAMiF,EAAMnQ,EAAOI,WAAW,MAC9B,GAAK+P,EAAL,CACA,IAAMhI,EAAOnI,EAAOgT,wBACdzT,GAAKwN,EAAEkG,UAAe,OAAJ9K,QAAI,IAAJA,OAAA,EAAAA,EAAMuC,OAAQ,IAAMoB,EACtCtM,GAAKuN,EAAEmG,UAAe,OAAJ/K,QAAI,IAAJA,OAAA,EAAAA,EAAMwC,MAAO,IAAMmB,EAC3C5J,QAAQC,IAAI5C,EAAGC,GACf,IAAM2T,EAAO,OAAGjI,QAAH,IAAGA,OAAH,EAAGA,EAAQkI,MAAM7T,EAAGC,GACjC0C,QAAQC,IAAIgR,GACRA,GACFtG,GAAqB,CACnBsD,MACAvL,MAAOuO,EAAQvO,MACfC,OAAQsO,EAAQtO,OAChBF,IAAKwO,EAAQxO,IACbgO,YAAazH,EAAO/L,UA8D8FkU,CAAYtG,IAAInD,MAAOsC,UAMjJ,SAASwG,EAAkBlJ,GAQzB,MAAkCQ,mBAAiB,IAAnD,mBAAO6I,EAAP,KAAkBS,EAAlB,KACA,EAA0BtJ,qBAA1B,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAAwBF,qBAAxB,mBAAOU,EAAP,KAAa6I,EAAb,KACA,EAAsBvJ,qBAAtB,mBAAOW,EAAP,KAAY6I,EAAZ,KACA,EAA0BxJ,qBAA1B,mBAAOyJ,EAAP,KAAcC,EAAd,KACA,EAA4B1J,qBAA5B,mBAAO2J,EAAP,KAAeC,EAAf,KAyBA,OAvBApJ,qBAAU,WACRtI,QAAQC,IAAI,QAASoL,OAAOsG,eAAe1U,MAAQoO,OAAOuG,YAC1D5R,QAAQC,IAAIoL,OAAOsG,gBACnB3J,EAASqD,OAAOsG,eAAe1U,MAAQoO,OAAOuG,YAC9CP,EAAQhG,OAAOsG,eAAeE,YAC9BP,EAAOjG,OAAOsG,eAAeG,WAC7BN,EAASnG,OAAOuG,YAAcvG,OAAOsG,eAAeE,WAAaxG,OAAOsG,eAAe1U,QACvFyU,EAAUrG,OAAO0G,aAAe1G,OAAOsG,eAAeG,UAAYzG,OAAOsG,eAAezU,WACvF,SAeWsF,IAAVuF,QAAgCvF,IAATgG,EAEvB,qBAAKf,UAAU,yDAAyDC,MAAO,CAACc,OAAMC,MAAK8I,QAAOE,UAAlG,SACE,sBAAKhK,UAAU,yDAAyDC,MAAO,CAACa,UAAU,SAAD,OAAWR,EAAX,MAAzF,UACE,oBAAGN,UAAU,kBAAb,qBAAwCH,EAAM3E,OAA9C,WACA,uBAAMqP,SAlBd,WACEhS,QAAQC,IAAIqH,EAAM7E,KAClB6E,EAAM2G,IAAIjI,YACVsB,EAAM2G,IAAIH,UAAUxG,EAAM7E,IAAI,GAAI6E,EAAM7E,IAAI,GAC1C6E,EAAM7E,IAAI,GAAK6E,EAAM7E,IAAI,GACzB6E,EAAM7E,IAAI,GAAK6E,EAAM7E,IAAI,IAC3B6E,EAAM2G,IAAI/H,SACV,IAAMyI,EAAW9P,KAAKC,MAAM,GAAKwI,EAAM2G,IAAInQ,OAAOb,MAAQqK,EAAMmJ,aAChEnJ,EAAM2G,IAAIW,KAAV,eAAyBD,EAAzB,YACArH,EAAM2G,IAAIY,UAAY,YACtBvH,EAAM2G,IAAIgB,SAAS0B,EAAWrJ,EAAM7E,IAAI,GAAI6E,EAAM7E,IAAI,IAAM6E,EAAM7E,IAAI,GAAK6E,EAAM7E,IAAI,KACrF6E,EAAMoJ,MAAMC,IAON,UACE,uBAAOlJ,UAAU,kBAAkBwK,WAAS,EAACtC,KAAK,OAAOY,MAAOI,EAAWf,SAAU,SAAA/E,GAAC,aAAIuG,EAAY,UAACvG,EAAEE,OAAOwF,MAAM,UAAhB,aAAC,EAAmB5P,kBAC1H,uBAAOgP,KAAK,SAASlI,UAAU,WAC/B,gCACE,wBAAQA,UAAU,6CAA6CiI,QAAS,kBAAMpI,EAAMoJ,SAApF,oBACA,wBAAQjJ,UAAU,6CAA6CkI,KAAK,SAApE,+BAOH,6BCnVIuC,MARf,WACE,OACE,qBAAKzK,UAAU,MAAf,SACE,cAACkB,EAAD,OCQSwJ,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBhF,MAAK,YAAkD,IAA/CiF,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCHdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEF9U,SAAS+U,eAAe,SAM1BX,M","file":"static/js/main.decc814e.chunk.js","sourcesContent":["import {BWImage} from './bw-image-reader';\n\nexport class ImageReader {\n  constructor(public width: number, public height: number, private data: ImageData) {\n    this.width = width;\n    this.height = height;\n    this.data = data;\n  }\n\n  getData() {\n    return this.data\n  }\n\n  getPixel(x: number, y: number) {\n    const i = this.width * x + y;\n    return [this.data.data[i], this.data.data[i + 1], this.data.data[i + 2], this.data.data[i + 3]]\n  }\n\n}","import { ImageReader } from \"./image-reader\";\n\ntype Corners = {l: number, r: number, t: number, b: number}\n\nexport class BWImage {\n  // mostly for internal use, usually using fromColor() or copy()\n  constructor(private data: Uint8Array, \n              public width: number, \n              public height: number, \n              private averageColor: number) {}\n\n  static fromColor(colorImage: ImageReader) {\n    const nPixels = colorImage.width * colorImage.height;\n    const bwData = new Uint8Array(nPixels);\n    let sum = 0;\n    let avg = 0;\n    const colorData: Uint8ClampedArray = colorImage.getData().data;\n    for (let i = 0; i < nPixels; i++) {\n      avg = Math.floor((colorData[4 * i] + colorData[4 * i + 1] + colorData[4 * i + 2]) / 3);\n      sum += avg;\n      bwData[i] = avg;\n    }\n    console.log(sum, nPixels)\n    return new BWImage(bwData, colorImage.width, colorImage.height, Math.floor(sum / nPixels))\n  }\n\n  static newBlank(w: number, h: number) {\n    return new BWImage(new Uint8Array(w * h).fill(255), w, h, 255);\n  }\n\n  getData() {\n    return this.data;\n  }\n\n  getAverageColor() {\n    return this.averageColor;\n  }\n\n  getPixeli(i: number) {\n    return this.data[i]\n  }\n\n  getPixel(x: number, y: number) {\n    return this.data[x + this.width * y]\n  }\n\n  setPixel(x: number, y: number, v: number) {\n    this.data[x + this.width * y] = v;\n  }\n\n  toClamped() {\n    const buff = new Uint8ClampedArray(this.width * this.height * 4);\n    for (var x = 0; x < this.width; x++) {\n      for (var y = 0; y < this.height; y++) {\n        buff[4 * (y * this.width + x)] = this.getPixel(x, y)\n        buff[1 + 4 * (y * this.width + x)] = this.getPixel(x, y)\n        buff[2 + 4 * (y * this.width + x)] = this.getPixel(x, y)\n        buff[3 + 4 * (y * this.width + x)] = 255\n      }\n    }\n    return buff;\n  }\n\n  toCanvas(): HTMLCanvasElement {\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    const imdata = new ImageData(this.toClamped(), this.width);\n    context?.putImageData(imdata, 0, 0);\n    return canvas;\n  }\n\n  copy() {\n    const newArray = new Uint8Array(this.width * this.height);\n    newArray.set(this.data);\n    return new BWImage(\n      newArray,\n      this.width,\n      this.height,\n      this.averageColor)\n  }\n\n  fillFromi(i: number, threshhold: number, corners: Corners, hiContrast: BWImage) {\n    const x = Math.floor(i % this.width);\n    const y = Math.floor(i / this.width);\n    const t = hiContrast;\n    this.fill(x, y, threshhold, corners, t)\n  }\n\n  fill(x: number, y: number, threshhold: number, corners: Corners, hiContrast: BWImage) {\n    if (this.getPixel(x, y) < threshhold) {\n      this.setPixel(x, y, 255);\n      hiContrast.setPixel(x, y, 0);\n      if (x < corners.l) corners.l = x;\n      if (x > corners.r) corners.r = x;\n      if (y < corners.t) corners.t = y;\n      if (y > corners.b) corners.b = y;\n\n      const xPlus = (x > 0)\n      const xMinus = (x < this.width - 1)\n      const yPlus = (y > 0)\n      const yMinus = (y < this.height - 1)\n\n      // Can definitely optimize checks\n      if (xMinus) this.fill(x - 1, y, threshhold, corners, hiContrast);\n      if (xPlus) this.fill(x + 1, y, threshhold, corners, hiContrast);\n      if (yMinus) this.fill(x, y - 1, threshhold, corners, hiContrast);\n      if (yPlus) this.fill(x, y + 1, threshhold, corners, hiContrast);\n\n      if (xMinus && yMinus) this.fill(x - 1, y - 1, threshhold, corners, hiContrast);\n      if (xMinus && yPlus) this.fill(x - 1, y + 1, threshhold, corners, hiContrast);\n      if (xPlus && yMinus) this.fill(x + 1, y - 1, threshhold, corners, hiContrast);\n      if (xPlus && yPlus) this.fill(x + 1, y + 1, threshhold, corners, hiContrast);\n    }\n  }\n\n}","type Solution = { word: string, start: [number, number], end: [number, number] }\n\nexport class WordSearch {\n  private letters: string[];\n  private tst: TST;\n  private words: string[];\n  constructor(\n    letters: string[],\n    public width: number,\n    public height: number,\n    words: string[],\n    private confidences: number[],\n    private boxes: number[][]) {\n    this.letters = letters.map((l) => l.toUpperCase())\n    this.words = words.map(m => m.toUpperCase()) || [];\n    this.tst = new TST();\n    this.initTST();\n    if (this.letters.length !== this.boxes.length) {\n      throw new Error('Length mismatch between boxes and letters.');\n    }\n  }\n  \n  initTST() {\n    this.tst = new TST();\n    // horizontal\n    for (let y = 0; y < this.height; y++) {\n      const line = Array.from(this.yieldLine(0, y, [1, 0])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: i, y: y, dx: 1, dy: 0}, i);\n      }\n      const reverse = Array.from(\n        this.yieldLine(this.width - 1, y, [-1, 0])\n      ).join(\"\");\n      for (let i = 0; i < reverse.length; i++) {\n        this.tst.add(reverse, {x: this.width - i - 1, y: y, dx: -1, dy: 0}, i);\n      }\n    }\n    // vertical\n    for (let x = 0; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, 0, [0, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: i, dx: 0, dy: 1}, i);\n      }\n      const reverse = Array.from(\n        this.yieldLine(x, this.height - 1, [0, -1])\n      ).join(\"\");\n      for (let i = 0; i < reverse.length; i++) {\n        this.tst.add(reverse, {x: x, y: this.height - i - 1, dx: 0, dy: -1}, i);\n      }\n    }\n    // diagonal down right\n    for (let y = this.height - 1; y >= 0; y--) {\n      const line = Array.from(this.yieldLine(0, y, [1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: 0, y: y, dx: 1, dy: 1}, i);\n      }\n    }\n    for (let x = 1; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, 0, [1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: 0, dx: 1, dy: 1}, i);\n      }\n    }\n\t\t// diagonal up left\n    for (let x = 0; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, this.height - 1, [-1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: this.height - 1, dx: -1, dy: -1}, i);\n      }\n    }\n\t\tfor (let y = this.height - 1; y >= 0; y--) {\n      const line = Array.from(this.yieldLine(this.width - 1, y, [-1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: this.width - 1, y: y, dx: -1, dy: -1}, i);\n      }\n    }\n\t\t// diagonal down left\n    for (let x = 0; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, 0, [-1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: 0, dx: -1, dy: 1}, i);\n      }\n    }\n\t\tfor (let y = 1; y < this.height; y++) {\n      const line = Array.from(this.yieldLine(this.width - 1, y, [-1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: this.width - 1, y: y, dx: -1, dy: 1}, i);\n      }\n    }\n\t\t// diagonal up right\n    for (let x = this.width - 1; x >= 0; x--) {\n      const line = Array.from(this.yieldLine(x, this.height - 1, [1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: this.height - 1, dx: 1, dy: -1}, i);\n      }\n    }\n\t\tfor (let y = this.height - 2; y >= 0; y--) {\n      const line = Array.from(this.yieldLine(0, y, [1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: 0, y: y, dx: 1, dy: -1}, i);\n      }\n    }\n  }\n\n  public solve(): Solution[] {\n    // const answerMap = new Map<string, PositionInfo[]>();\n    console.log(this.letters)\n    const solutions: {word: string, start: [number, number], end: [number, number], dir: [number, number]}[] = [];\n    for (let word of this.words) {\n      // answerMap.set(word, this.tst.get(word));\n      const pos = this.tst.get(word);\n      pos.forEach(p => {\n        solutions.push({\n          word: word,\n          start: [p.x, p.y],\n          end: [p.x + (word.length - 1) * p.dx, p.y + (word.length - 1) * p.dy],\n          dir: [p.dx, p.dy]\n        })\n      })\n    }\n    console.log(solutions);\n    const withBoxes: Solution[] = solutions.map(a => ({...a, start: this.getBoxCenter(...a.start), end: this.getBoxCenter(...a.end)}))\n    return withBoxes;\n  }\n\n  private *yieldLine(startX: number, startY: number, dirs: [number, number]) {\n    let x = startX,\n      y = startY;\n    while (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      yield this.letters[x + this.width * y];\n      x += dirs[0];\n      y += dirs[1];\n    }\n  }\n\n  getLetter(x: number, y: number) {\n    return this.letters[this.width * y + x];\n  }\n\n  setWords(words: string[]) {\n    this.words = words.map(w => w.toUpperCase());\n  }\n\n  changeLetter(i: number, l: string) {\n    this.letters[i] = l.toUpperCase();\n    this.initTST();\n  }\n\n  getBoxCenter(x: number, y: number): [number, number] {\n    const b = this.boxes[this.width * y + x]\n    return [b[0] + (b[1] - b[0]) / 2, b[2] + (b[3] - b[2]) / 2];\n  }\n\n  getConfidence(i: number) {\n    return this.confidences[i] || 0;\n  }\n\n  // tells whether the given coordinate is inside a box,\n  // returns the index of the box and the letter \n  // undefined if the coordinate is not in a box\n  inBox(x: number, y: number): {index: number, letter: string, box: number[]} | undefined {\n    let r: {index: number, letter: string, box: number[]} | undefined = undefined;\n    this.boxes.forEach((box, i) => {\n      if ((box[0] < x) && (x < box[1]) && (box[2] < y) && (y < box[3])) {\n        r = {index: i, letter: this.letters[i], box};\n      }\n    });\n    return r;\n  }\n\n  getBoxes() {\n    return this.boxes;\n  }\n\n  getLetters() {\n    return this.letters;\n  }\n\n  getWords() {\n    return this.words;\n  }\n\n  toString() {\n    let sb = '';\n    this.letters.forEach((l, i) => {\n      if (i !== 0 && i % this.width === 0) {\n        sb += '\\n'\n      }\n      sb += l + ' '\n    })\n    return sb;\n  }\n}\n\ntype PositionInfo = {\n  x: number,\n  y: number,\n  dx: number,\n  dy: number,\n}\n\nclass TSTNode {\n  public childL: TSTNode | null = null;\n  public childR: TSTNode | null = null;\n  public childM: TSTNode | null = null;\n  public endings: PositionInfo[] = [];\n  constructor(public letter: string) {}\n\n  public addEnding(info: PositionInfo) {\n    this.endings.push(info);\n  }\n\n  public static createToBottom(\n    s: string,\n    index: number,\n    info: PositionInfo\n  ) {\n    const newNode = new TSTNode(s[index]);\n    if (index === s.length - 1) {\n      newNode.addEnding(info);\n      return newNode;\n    }\n    newNode.childM = this.createToBottom(s, index + 1, info);\n    newNode.addEnding(info);\n    return newNode;\n  }\n}\n\nexport class TST {\n  private root: TSTNode | null = null;\n\n  public get(s: string): PositionInfo[] {\n    if (!this.root) return [];\n    return this.getRecurse(s, 0, this.root);\n  }\n\n  private getRecurse(\n    s: string,\n    index: number,\n    curr: TSTNode\n  ): PositionInfo[] {\n    if (curr.letter === s[index]) {\n      if (index === s.length - 1) return curr.endings;\n      if (curr.childM) return this.getRecurse(s, index + 1, curr.childM);\n      else return [];\n    } else if (s[index] > curr.letter) {\n      if (curr.childR) return this.getRecurse(s, index, curr.childR);\n      else return [];\n    } else {\n      if (curr.childL) return this.getRecurse(s, index, curr.childL);\n      else return [];\n    }\n  }\n\n  public add(s: string, info: PositionInfo, startIndex?: number) {\n    if (!this.root)\n      this.root = TSTNode.createToBottom(s, startIndex || 0, info);\n    this.addRecurse(this.root, s, startIndex || 0, info);\n  }\n\n  private addRecurse(\n    node: TSTNode,\n    s: string,\n    index: number,\n    info: PositionInfo\n  ) {\n    if (s[index] === node.letter) {\n      node.addEnding(info);\n      if (index === s.length - 1) {\n        return;\n      }\n      this.addRecurse(\n        node.childM ||\n          (node.childM = TSTNode.createToBottom(s, index + 1, info)),\n        s,\n        index + 1,\n        info\n      );\n    } else if (s[index] > node.letter) {\n      if (node.childR) {\n        this.addRecurse(node.childR, s, index, info);\n      } else {\n        node.childR = TSTNode.createToBottom(s, index, info);\n      }\n    } else {\n      if (node.childL) {\n        this.addRecurse(node.childL, s, index, info);\n      } else {\n        node.childL = TSTNode.createToBottom(s, index, info);\n      }\n    }\n  }\n}\n\nexport class WordSearchNew {\n  private tst: TST;\n  private width: number;\n  private height: number;\n  constructor(private letters: string[], private words: string[]) {\n    this.width = this.letters[0].length;\n    this.height = this.letters.length;\n    this.tst = new TST();\n    this.initTST();\n  }\n\n  initTST() {\n    this.tst = new TST();\n    // horizontal\n    for (let y = 0; y < this.height; y++) {\n      const line = Array.from(this.yieldLine(0, y, [1, 0])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: i, y: y, dx: 1, dy: 0}, i);\n      }\n      const reverse = Array.from(\n        this.yieldLine(this.width - 1, y, [-1, 0])\n      ).join(\"\");\n      for (let i = 0; i < reverse.length; i++) {\n        this.tst.add(reverse, {x: this.width - i - 1, y: y, dx: -1, dy: 0}, i);\n      }\n    }\n    // vertical\n    for (let x = 0; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, 0, [0, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: i, dx: 0, dy: 1}, i);\n      }\n      const reverse = Array.from(\n        this.yieldLine(x, this.height - 1, [-1, 0])\n      ).join(\"\");\n      for (let i = 0; i < reverse.length; i++) {\n        this.tst.add(reverse, {x: x, y: this.height - i - 1, dx: -1, dy: 0}, i);\n      }\n    }\n    // diagonal down right\n    for (let y = this.height - 1; y >= 0; y--) {\n      const line = Array.from(this.yieldLine(0, y, [1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: 0, y: y, dx: 1, dy: 1}, i);\n      }\n    }\n    for (let x = 1; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, 0, [1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: 0, dx: 1, dy: 1}, i);\n      }\n    }\n\t\t// diagonal up left\n    for (let x = 0; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, this.height - 1, [-1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: this.height - 1, dx: -1, dy: -1}, i);\n      }\n    }\n\t\tfor (let y = this.height - 1; y >= 0; y--) {\n      const line = Array.from(this.yieldLine(this.width - 1, y, [-1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: this.width - 1, y: y, dx: -1, dy: -1}, i);\n      }\n    }\n\t\t// diagonal down left\n    for (let x = 0; x < this.width; x++) {\n      const line = Array.from(this.yieldLine(x, 0, [-1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: 0, dx: -1, dy: 1}, i);\n      }\n    }\n\t\tfor (let y = 1; y < this.height; y++) {\n      const line = Array.from(this.yieldLine(this.width - 1, y, [-1, 1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: this.width - 1, y: y, dx: -1, dy: 1}, i);\n      }\n    }\n\t\t// diagonal up right\n    for (let x = this.width - 1; x >= 0; x--) {\n      const line = Array.from(this.yieldLine(x, this.height - 1, [1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: x, y: this.height - 1, dx: 1, dy: -1}, i);\n      }\n    }\n\t\tfor (let y = this.height - 2; y >= 0; y--) {\n      const line = Array.from(this.yieldLine(0, y, [1, -1])).join(\"\");\n      for (let i = 0; i < line.length; i++) {\n        this.tst.add(line, {x: 0, y: y, dx: 1, dy: -1}, i);\n      }\n    }\n  }\n\n  private *yieldLine(startX: number, startY: number, dirs: [number, number]) {\n    let x = startX,\n      y = startY;\n    while (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      yield this.letters[y][x];\n      x += dirs[0];\n      y += dirs[1];\n    }\n  }\n\n  public solve() {\n    const answerMap = new Map<string, PositionInfo[]>();\n    for (let word of this.words) {\n      answerMap.set(word, this.tst.get(word));\n    }\n    return answerMap;\n  }\n}\nconst test = \n`T I I S I R F R O S T M R E O U I F E L\nE D I L C E I L N A O F A S E O R Y H T\nS E E T E R S O C H R I S T M A S F A S\nA H B D O H W E O Y E T R H C E S I A O\nA E H H T S R C A H N R E S A A N H T I\nD D E R T P O Y E S S D S T E C S P K S\nO O E O H W D H A L T W N H C T E G R O\nI A R R E N I R L N E S E S N E T T I M\nI M V E I A E E T F W S I E D M C T P R\nL H T W H S B I L R S L E S O A A E D O\nB R S U I H T S L E D C E A C O L D A R\nR L T H G O E C A E L D N A C S A H H H\nE R A I C V I N O Z B O O T S A L H C O\nS B E N S E D E C E M B E R R O E B H P\nO L F T K L L E O L P E K A L F W O N S\nS L D R A E N I A D R A Z Z I L B T A H\nE I O L H E T T N N A T I S I M E N E U\nU H P S N O W P H T I R N A M W O N S S\nF C N O S A E S B P T A O G B D L R T R\nE C A L P E R I F G N R B N C E S E N O`;\n","export class Gradient {\n  constructor(private stops: [number, number, number][], \n              private positions: number[]) {}\n\n  eval(n: number) {\n    let index = 0;\n    if (n == 0) {\n      return this.stops[0]\n    }\n    while (n > this.positions[index]) \n      index++\n    const r = (n - this.positions[index - 1]) / (this.positions[index] - this.positions[index - 1])\n    return (this.stops[index - 1].map((c,i) => c + (this.stops[index][i] - c) * r));\n  }\n\n  static stoplight() {\n    return new Gradient([[255, 127, 127], [255, 0, 0], [0, 255, 0]], [0, .5, 1]);\n  }\n}","import { BWImage } from \"./bw-image-reader\";\nimport { ImageReader } from \"./image-reader\";\nimport * as tf from '@tensorflow/tfjs';\nimport { WordSearch } from \"./solver\";\nimport { Gradient } from \"./gradient\";\nimport { Contexts } from \"../components/read-and-solve\";\n\nconst alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\ntype Inference = [string, number][];\n\nexport function analyzeImage(img: ImageReader, words: string[], contexts: Contexts, modelPath?: string) {\n  console.log('analyzeImage');\n  return new Promise<WordSearch>(async (resolve, reject) => {\n    const bw = BWImage.fromColor(img);\n    const toFill = bw.copy();\n    const hiContrast = BWImage.newBlank(bw.width, bw.height);\n\n    const nPixels = bw.width * bw.height;\n    const threshhold = toFill.getAverageColor() - 25;\n    const corners = { l: toFill.width, r: 0, t: toFill.height, b: 0 }\n    const boxes = [];\n    for (let i = 0; i < nPixels; i++) {\n      if (toFill.getPixeli(i) < threshhold) {\n        corners.l = toFill.width;\n        corners.r = 0;\n        corners.t = toFill.height;\n        corners.b = 0;\n        toFill.fillFromi(i, threshhold, corners, hiContrast)\n        boxes.push([corners.l, corners.r, corners.t, corners.b])\n      }\n    }\n\n    // const maxHeight = boxes.reduce((max, i) => Math.max(max, i[3] - i[2]), 0);\n    // const filteredBoxes = boxes.filter((b) => b[3] - b[2] > maxHeight * 0.5);\n\n    const heightThreshold = 8;\n    const heights = boxes.map(box => box[3] - box[2]);\n    const maxHeight = Math.max(...heights);\n    const freqs = new Array(maxHeight + 1).fill(0);\n    heights.forEach(h => freqs[h]++);\n    const argmax: [number, number] = freqs.reduce((maxes, freq, i) => freq > maxes[0] ? [freq, i] : maxes, [heights[0], 0]);\n    // choose boxes within heightThreshold of argmax height\n    const filteredBoxes = boxes.filter(b => argmax[1] - heightThreshold < b[3] - b[2] && b[3] - b[2] <= argmax[1] + heightThreshold);\n    filteredBoxes.sort((a, b) => a[2] - b[2] > argmax[1] ? 1 : a[0] - b[0]);\n    const ws = await analyzeBoxes(hiContrast, filteredBoxes, words, contexts, modelPath);\n    resolve(ws);\n  })\n}\n\nasync function analyzeBoxes(hiContrast: BWImage, boxes: number[][], words: string[], contexts: Contexts, modelPath?: string) {\n  console.log('analyzeBoxes')\n  const cropBoxes = new Float32Array(boxes.length * 4);\n  const EXTRA_PAD = 5;\n  const w = hiContrast.width - 1;\n  const h = hiContrast.height - 1;\n  boxes.forEach((b, i) => {\n    const dx = b[1] - b[0]\n    const dy = b[3] - b[2]\n    const max = Math.max(dx, dy);\n    const padX = Math.ceil((max - dx) / 2) + EXTRA_PAD;\n    const padY = Math.ceil((max - dy) / 2) + EXTRA_PAD;\n    const x1 = b[0] - padX;\n    const y1 = b[2] - padY;\n    const x2 = b[1] + padX;\n    const y2 = b[3] + padY;\n    cropBoxes[i * 4] = y1 / h;\n    cropBoxes[i * 4 + 1] = x1 / w;\n    cropBoxes[i * 4 + 2] = y2 / h;\n    cropBoxes[i * 4 + 3] = x2 / w;\n  })\n\n  const boxIndices = new Int32Array(boxes.length).fill(0);\n\n  const allImageData = hiContrast.getData();\n\n  // move arrays into tensors to crop the image into letters \n  const imageTensor: tf.Tensor<tf.Rank.R4> = tf.tensor(allImageData, [1, hiContrast.height, hiContrast.width, 1]);\n  const boxTensor: tf.Tensor<tf.Rank.R2> = tf.tensor(cropBoxes, [boxes.length, 4]);\n  const boxIndicesTensor: tf.Tensor<tf.Rank.R1> = tf.tensor(boxIndices, [boxes.length]);\n  const CROP_SIZE: [number, number] = [28, 28]\n\n  // separate images of each letter and send them to tf model\n  const resizedTensor = tf.image.cropAndResize(imageTensor, boxTensor, boxIndicesTensor, CROP_SIZE);\n  const letters = await infer(resizedTensor, modelPath);\n\n  // put boxes on box canvas\n  contexts.box.canvas.width = contexts.img.canvas.width;\n  contexts.box.canvas.height = contexts.img.canvas.height;\n  const g = Gradient.stoplight();\n  contexts.box.lineWidth = 5;\n  boxes.forEach((b, i) => {\n    contexts.box.strokeStyle = `rgb(${g.eval(letters[i][1]).join(',')})`;\n    contexts.box.beginPath();\n    contexts.box.rect(b[0] - 3, b[2] - 3, b[1] - b[0] + 3, b[3] - b[2] + 3)\n    contexts.box.stroke();\n  });\n\n  // find width and height of puzzle\n  let width = 0;\n  while (boxes[width][0] < boxes[width + 1][0]) width++;\n  width++;\n  const height = boxes.length / width;\n  const confidences = letters.map(l => l[1]);\n  console.log(width, height);\n\n  return new WordSearch(letters.map(l => l[0]), width, height, words, confidences, boxes);\n}\n\nfunction infer(t: tf.Tensor<tf.Rank.R4>, modelPath?: string) {\n  console.log('Inferring with ', modelPath)\n  return new Promise<Inference>(async (resolve, reject) => {\n    const model = await tf.loadGraphModel(modelPath || './models/bw_no_rotate/model.json');\n    const out = model.predict(t) as tf.Tensor<tf.Rank>;\n    console.log(out.shape);\n    const ds = out.dataSync();\n    const maxes = Array.from(tf.argMax(out, 1).dataSync());\n    // scale output values linearly between 0 and 1\n    const normalized = normalize(ds, 0, 1);\n    resolve (maxes.map((o, i) => [alphabet[o], arrayMax(normalized.slice(26 * i, 26 * (i + 1)))]))\n  })\n}\n\nfunction normalize(data: Float32Array | Int32Array | Uint8Array | number[], a: number, b: number) {\n  const max = arrayMax(data)\n  const min = arrayMin(data)\n  return data.map(d => ((d - min) / (max - min)) * (b - a) + a)\n}\n\n\nfunction arrayMax(a: Float32Array | Int32Array | Uint8Array | number[]) {\n  let m = a[0];\n  for (let i = 1; i < a.length; i++) {\n    if (a[i] > m)\n      m = a[i]\n  }\n  return m;\n}\n\nfunction arrayMin(a: Float32Array | Int32Array | Uint8Array | number[]) {\n  let m = a[0];\n  for (let i = 1; i < a.length; i++) {\n    if (a[i] < m)\n      m = a[i]\n  }\n  return m;\n}","import { useEffect, useRef, useState } from \"react\";\n\n\nexport function Sparkles(props: {width: number, height: number, count: number, scale?: number}) {\n    const ref = useRef<HTMLDivElement>(null);\n\n    return (\n        <div \n            ref={ref} \n            className='relative w-full h-full origin-top-left' \n            style={{ width: `${props.width}px`, height: `${props.height}px`}}>\n            {new Array(props.count).fill(0).map(_ => <Dot height={props.height} width={props.width} />)}\n        </div>\n    )\n}\n\nfunction Dot(props: { width?: number, height?: number }) {\n\n    const [scale, setScale] = useState<number>();\n    const [x, setX] = useState<number>();\n    const [y, setY] = useState<number>();\n\n    useEffect(() => {\n        setX(Math.random() * ((props.width || 24) - 24));\n        setY(Math.random() * ((props.height || 24) - 24));\n        setScale(0);\n        setTimeout(() => grow(), Math.random() * 1000);\n    }, [props.height, props.width])\n\n    function grow() {\n        setScale(Math.random() * .5 + .5);\n        setTimeout(() => shrink(), 1000)\n    }\n\n    function shrink() {\n        setScale(0);\n        setTimeout(() => {\n            setX(Math.random() * ((props.width || 24) - 24));\n            setY(Math.random() * ((props.height || 24) - 24));\n            grow();\n        }, 1000)\n    }\n\n    return (\n        <div\n            className=\"absolute w-6 h-6 rounded-full bg-blue-500 transform transition-transform duration-1000\"\n            style={{ transform: `scale(${scale})`, left: x, top: y }}\n        ></div>\n    )\n}","import React, { useEffect, useRef, useState } from \"react\";\nimport { ImageReader } from \"../logic/image-reader\";\nimport { analyzeImage } from \"../logic/read-and-solve\";\nimport englishwords from \"../logic/usa2.json\";\nimport '../App.css';\nimport { WordSearch } from \"../logic/solver\";\nimport Tesseract from \"tesseract.js\";\nimport { Gradient } from \"../logic/gradient\";\nimport { Sparkles } from \"./sparkles\";\nexport type Contexts = {\n  img: CanvasRenderingContext2D,\n  box: CanvasRenderingContext2D,\n  letter: CanvasRenderingContext2D,\n  line: CanvasRenderingContext2D\n}\n\nexport type ImageLetter = {\n  l: number, r: number, t: number, b: number,\n  letter: string,\n\n}\n\nconst modelNames = ['./models/bw_no_rotate/model.json', './models/artificial/model.json']\n\nexport function WordsearchSolver() {\n  const imgCanvas = useRef<HTMLCanvasElement>(null);\n  const boxCanvas = useRef<HTMLCanvasElement>(null);\n  const letterCanvas = useRef<HTMLCanvasElement>(null);\n  const lineCanvas = useRef<HTMLCanvasElement>(null);\n  const [puzzle, setPuzzle] = useState<WordSearch>();\n  const [wordString, setWordString] = useState<string>('');\n  const [imgVisible, setImgVisible] = useState<boolean>(true);\n  const [boxesVisible, setBoxesVisible] = useState<boolean>(false);\n  const [linesVisible, setLinesVisible] = useState<boolean>(true);\n  const [lettersVisible, setLettersVisible] = useState<boolean>(false);\n  const [rescaleVal, setRescaleVal] = useState<number>(1);\n  const [letterOffset, setLetterOffset] = useState<number>(0);\n  const [letterStyle, setLetterStyle] = useState<any>();\n  const [modelIndex, setModelIndex] = useState<number>(0);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [canvasWidth, setcanvasWidth] = useState<number>(0);\n  const [canvasHeight, setCanvasHeight] = useState<number>(0);\n  const [changeLetterModal, setChangeLetterModal] = useState<{\n    ctx: CanvasRenderingContext2D,\n    index: number,\n    letter: string,\n    box: number[],\n    puzzleWidth: number\n  } | undefined>();\n\n  useEffect(() => {\n    window.addEventListener('resize', rescale);\n    return (() => window.removeEventListener('resize', rescale))\n  }, [])\n\n  useEffect(() => {\n    drawPuzzle();\n  }, [puzzle])\n\n  function test() {\n    return `scale(${rescaleVal}) translateX(${letterOffset}px)`\n  }\n\n  useEffect(() => {\n    const newLetterStyle = {\n      display: toDisp(lettersVisible),\n      transform: test()\n    };\n    setLetterStyle(newLetterStyle)\n  }, [lettersVisible, rescaleVal, letterOffset])\n\n  function readWords(e: React.ChangeEvent<HTMLInputElement>) {\n    if (e.target.files?.length && e.target.files.length > 0) {\n      const imgPath: string = URL.createObjectURL(e.target.files[0]);\n      console.log('REcognizing')\n      console.log(imgPath)\n      Tesseract.recognize(imgPath, 'eng')\n        .then(res => {\n          console.log(res);\n          setWordString(res.data.text);\n        })\n        .catch(err => console.log(err));\n    } else {\n      alert('Invalid file');\n    }\n  }\n\n  function onFileInput(e: React.ChangeEvent<HTMLInputElement>) {\n    const img = imgCanvas.current?.getContext('2d');\n    const box = boxCanvas.current?.getContext('2d');\n    const letter = letterCanvas.current?.getContext('2d');\n    const line = lineCanvas.current?.getContext('2d');\n    if (!(img && box && letter && line)) return;\n    const contexts: Contexts = { img, box, letter, line };\n    if (e.target.files?.length && e.target.files.length > 0) {\n      const f: File = e.target.files[0];\n      const image = new Image();\n      const url = window.URL || window.webkitURL,\n        src = url.createObjectURL(f);\n      image.src = src;\n      image.onload = () => {\n        const screenWidth = window.outerWidth;\n        const w = Math.min(screenWidth, 400);\n        const h = (w / image.width) * image.height;\n        img.canvas.width = image.width;\n        img.canvas.height = image.height;\n        setcanvasWidth(image.width);\n        setCanvasHeight(image.height);\n        rescale();\n\n        img.drawImage(image, 0, 0, image.width, image.height)\n        console.log(\"Image size: \", image.width, 'x', image.height)\n        const idt = img.getImageData(0, 0, image.width, image.height)\n        console.log(idt)\n        const imgRead = new ImageReader(image.width, image.height, idt)\n        setLoading(true);\n        analyzeImage(imgRead, getWords(), contexts, modelNames[modelIndex])\n          .then((ws) => {\n            setPuzzle(ws);\n          });\n      }\n    }\n  }\n\n  function getWords() {\n    const words = wordString.split(/[^a-zA-Z0-9]+/);\n    if (words[0] === '') words.splice(0, 1);\n    if (words[words.length - 1] === '') words.pop();\n    if (words.length > 0) {\n      console.log(words);\n      return words;\n    }\n    return englishwords.filter(w => w.length > 3);\n  }\n\n  function drawPuzzle() {\n    if (!puzzle) return;\n    const solutions = puzzle.solve();\n    console.log(solutions);\n    console.log(\"Found\", solutions.length, \"words out of\", puzzle.getWords().length)\n    console.log(puzzle.toString())\n\n    const imgCtx = imgCanvas.current?.getContext('2d');\n    if (!imgCtx) return;\n\n    const lineCtx = lineCanvas.current?.getContext('2d');\n    if (lineCtx) {\n      lineCtx.canvas.width = imgCtx.canvas.width;\n      lineCtx.canvas.height = imgCtx.canvas.height;\n      lineCtx.lineWidth = 5;\n      lineCtx.strokeStyle = '#5555FFFF';\n      solutions.forEach(s => {\n        lineCtx.beginPath();\n        lineCtx.moveTo(s.start[0], s.start[1])\n        lineCtx.lineTo(s.end[0], s.end[1])\n        lineCtx.stroke();\n      })\n    }\n\n    const letterCtx = letterCanvas.current?.getContext('2d');\n    if (letterCtx) {\n      const fontSize = Math.floor(.5 * imgCtx.canvas.width / puzzle.width);\n      letterCtx.canvas.width = imgCtx.canvas.width;\n      letterCtx.canvas.height = imgCtx.canvas.height;\n      letterCtx.font = `bold ${fontSize}px Arial`;\n      letterCtx.fillStyle = '#FF0077FF';\n      const letters = puzzle.getLetters();\n      const g = Gradient.stoplight();\n      puzzle.getBoxes().forEach((s, i) => {\n        letterCtx.fillStyle = `rgb(${g.eval(puzzle.getConfidence(i)).join(',')})`;\n        letterCtx.fillText(letters[i][0], s[0], s[3]);\n      });\n    }\n    setLoading(false);\n  }\n\n  function reSolve() {\n    const words = getWords();\n    puzzle?.setWords(words);\n    const solutions = puzzle?.solve();\n    console.log(solutions);\n    const lineCtx = lineCanvas.current?.getContext('2d');\n    if (!solutions) return;\n    lineCtx?.clearRect(0, 0, lineCtx.canvas.width, lineCtx.canvas.height);\n    if (lineCtx) {\n      lineCtx.lineWidth = 5;\n      lineCtx.strokeStyle = '#5555FFFF';\n      solutions.forEach(s => {\n        lineCtx.beginPath();\n        lineCtx.moveTo(s.start[0], s.start[1])\n        lineCtx.lineTo(s.end[0], s.end[1])\n        lineCtx.stroke();\n      })\n    }\n  }\n\n  function rescale() {\n    // rescale canvases\n    const ctx = imgCanvas.current?.getContext('2d');\n    if (!ctx) return;\n    let xProp = ctx.canvas.width / window.outerWidth;\n    const yProp = ctx.canvas.height / window.outerHeight;\n    if (window.outerWidth > 768) {\n      xProp *= .8;\n    }\n    const big = Math.max(xProp, yProp);\n    setRescaleVal(.9 / big);\n  }\n\n  function canvasClick(e: React.MouseEvent<HTMLCanvasElement, MouseEvent>) {\n    const canvas = letterCanvas.current;\n    console.log(\"CLIDKED\")\n    if (!canvas || !puzzle) return;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    const rect = canvas.getBoundingClientRect();\n    const x = (e.clientX - (rect?.left || 0)) / rescaleVal;\n    const y = (e.clientY - (rect?.top || 0)) / rescaleVal;\n    console.log(x, y)\n    const clicked = puzzle?.inBox(x, y);\n    console.log(clicked);\n    if (clicked) {\n      setChangeLetterModal({\n        ctx,\n        index: clicked.index,\n        letter: clicked.letter,\n        box: clicked.box,\n        puzzleWidth: puzzle.width\n      })\n    }\n  }\n\n  function onChangeSumbit(newLetter: string | undefined) {\n    if (!changeLetterModal) return;\n    if (newLetter) {\n      puzzle?.changeLetter(changeLetterModal.index, newLetter);\n      reSolve();\n    }\n    setChangeLetterModal(undefined);\n  }\n\n  const toDisp = (b: boolean) => b ? 'block' : 'none';\n\n  useEffect(() => console.log(letterOffset), [letterOffset])\n\n  return (\n    <div className='flex flex-col md:flex-row'>\n      <div className='w-screen max-w-screen grid grid-flow-row justify-center md:justify-start p-4 md:w-1/5 md:flex flex-col items-start md:pl-4'>\n        <div className=\"flex flex-row\">\n          {\n            modelNames\n              .map((model, i) => {\n                const inter = model.substring(0, model.lastIndexOf('/'));\n                const name = inter.substring(inter.lastIndexOf('/') + 1);\n                return <button className={`py-1 rounded-xl px-2 my-2 mr-2 md:my-4 max-w-xs ${modelIndex === i ? 'bg-blue-600' : 'bg-white'} hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setModelIndex(i)}>{name}</button>\n              })\n          }\n        </div>\n        <p className=\"text-white text-left text-sm\">Choose an image of the puzzle</p>\n        <input type='file' onChange={(e) => onFileInput(e)} />\n        <p className=\"text-white text-left text-sm\">Choose an image of the words to find</p>\n        <input type='file' onChange={(e) => readWords(e)} />\n        <p className=\"text-white text-left text-sm\">Or type the words to find below, or leave it blank to search for any words</p>\n        <div className='w-2/3 mt-4 w-full max-w-xs flex'>\n          <textarea className='border-none p-1 bg-blue-50 rounded-xl flex-grow' rows={3} value={wordString} onChange={(e) => setWordString(e.target.value)} />\n          <button className='w-8 h-8 bg-blue-600 rounded-lg ml-3 self-end' onClick={reSolve}></button>\n        </div>\n        {changeLetterModal && <ChangeLetterModal ctx={changeLetterModal.ctx}\n          index={changeLetterModal.index}\n          letter={changeLetterModal.letter}\n          box={changeLetterModal.box}\n          puzzleWidth={changeLetterModal.puzzleWidth}\n          close={(newLetter) => onChangeSumbit(newLetter)}\n        />}\n        <button className={`py-1 rounded-xl px-2 my-2 md:my-4 max-w-xs ${imgVisible ? 'bg-blue-600' : 'bg-gray-100'} hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setImgVisible(!imgVisible)} >Toggle Image</button>\n        <button className={`py-1 rounded-xl px-2 my-2 md:my-4 max-w-xs ${boxesVisible ? 'bg-blue-600' : 'bg-gray-100'} hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setBoxesVisible(!boxesVisible)} >Toggle Boxes</button>\n        <button className={`py-1 rounded-xl px-2 my-2 md:my-4 max-w-xs ${linesVisible ? 'bg-blue-600' : 'bg-gray-100'} hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setLinesVisible(!linesVisible)} >Toggle Solutions</button>\n        <button className={`py-1 rounded-xl px-2 my-2 md:my-4 max-w-xs ${lettersVisible ? 'bg-blue-600' : 'bg-gray-100'} hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setLettersVisible(!lettersVisible)} >Toggle Letters</button>\n        <div className='flex flex-row justify-center'>\n          <button className={`py-1 rounded-l-xl m-r-1 px-2 my-2 md:my-4 max-w-xs bg-blue-600 hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setLetterOffset(letterOffset - 5)} >{'<'}</button>\n          <button className={`py-1 rounded-r-xl m-l-1 px-2 my-2 md:my-4 max-w-xs bg-blue-600 hover:bg-blue-400 transform transition transition-color duration-300`} onClick={() => setLetterOffset(letterOffset + 5)} >{'>'}</button>\n        </div>\n        {/* </div> */}\n      </div>\n      <div className='flex relative justify-center' style={{}}>\n        <canvas className='absolute origin-top-center md:origin-top-left md:left-0' ref={imgCanvas} style={{ display: toDisp(imgVisible), transform: `scale(${rescaleVal})` }}></canvas>\n        {loading && <Sparkles width={canvasWidth * rescaleVal} height={canvasHeight * rescaleVal} count={40} />}\n        <canvas className='absolute origin-top-center md:origin-top-left md:left-0' ref={boxCanvas} style={{ display: toDisp(boxesVisible), transform: `scale(${rescaleVal})` }}></canvas>\n        <canvas className='absolute origin-top-center md:origin-top-left md:left-0' ref={lineCanvas} style={{ display: toDisp(linesVisible), transform: `scale(${rescaleVal})` }}></canvas>\n        <canvas className='absolute origin-top-center md:origin-top-left md:left-0 z-20' ref={letterCanvas} onClick={e => canvasClick(e)} style={letterStyle}></canvas>\n      </div>\n    </div>\n  )\n}\n\nfunction ChangeLetterModal(props: {\n  ctx: CanvasRenderingContext2D,\n  index: number,\n  letter: string,\n  box: number[],\n  puzzleWidth: number,\n  close: (newLetter?: string) => void\n}) {\n  const [newLetter, setNewLetter] = useState<string>('');\n  const [scale, setScale] = useState<number>();\n  const [left, setLeft] = useState<number>();\n  const [top, setTop] = useState<number>();\n  const [right, setRight] = useState<number>();\n  const [bottom, setBottom] = useState<number>();\n\n  useEffect(() => {\n    console.log('scale', window.visualViewport.width / window.innerWidth);\n    console.log(window.visualViewport)\n    setScale(window.visualViewport.width / window.innerWidth);\n    setLeft(window.visualViewport.offsetLeft);\n    setTop(window.visualViewport.offsetTop);\n    setRight(window.innerWidth - (window.visualViewport.offsetLeft + window.visualViewport.width));\n    setBottom(window.innerHeight - (window.visualViewport.offsetTop + window.visualViewport.height));\n  }, []);\n\n  function onSubmit() {\n    console.log(props.box)\n    props.ctx.beginPath();\n    props.ctx.clearRect(props.box[0], props.box[2],\n      props.box[1] - props.box[0],\n      props.box[3] - props.box[2]);\n    props.ctx.stroke();\n    const fontSize = Math.floor(.5 * props.ctx.canvas.width / props.puzzleWidth);\n    props.ctx.font = `bold ${fontSize}px Arial`;\n    props.ctx.fillStyle = '#2222FFFF';\n    props.ctx.fillText(newLetter, props.box[0], props.box[2] + (props.box[3] - props.box[2]));\n    props.close(newLetter);\n  }\n  if (scale !== undefined && left !== undefined) {\n    return (\n      <div className=\"absolute z-50 flex flex-row justify-center items-start\" style={{left, top, right, bottom}}>\n        <div className=\"border-4 rounded-lg border-blue-500 bg-black px-5 py-3\" style={{transform: `scale(${scale})`}}>\n          <p className=\"text-white my-2\">Change \"{props.letter}\" to:</p>\n          <form onSubmit={onSubmit}>\n            <input className='pl-2 rounded-md' autoFocus type='text' value={newLetter} onChange={e => setNewLetter(e.target.value[0]?.toUpperCase())}></input>\n            <input type='submit' className=\"hidden\" />\n            <div>\n              <button className='bg-blue-500 rounded-md px-3 py-1 mx-1 my-3' onClick={() => props.close()}>Cancel</button>\n              <button className='bg-blue-500 rounded-md px-3 py-1 mx-1 my-3' type='submit'>Submit</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  } else {\n    return <></>\n  }\n}","import './App.css';\nimport { WordsearchSolver } from './components/read-and-solve';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <WordsearchSolver />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}